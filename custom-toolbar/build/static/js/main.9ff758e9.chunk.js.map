{"version":3,"sources":["components/EditingTools/index.module.scss","components/EditingTools/index.js","containers/index.js","sources/xml.js","App.js","index.js","containers/Bpmn.module.scss"],"names":["module","exports","editingTools","controlList","control","openFile","line","zoom","zoomIn","zoomOut","undo","redo","save","download","image","open","EditingTools","handleOpen","_this","file","click","_this2","this","_this$props","props","onOpenFIle","onZoomIn","onZoomOut","onZoomReset","onUndo","onRedo","onSave","onDownloadXml","onDownloadSvg","react_default","a","createElement","className","styles","concat","ref","type","onChange","title","onClick","Component","Bpmn","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","data","name","dataTrack","document","setAttribute","encodeURIComponent","body","appendChild","removeChild","handleOpenFile","e","that","assertThisInitialized","target","files","reader","FileReader","readAsText","onload","event","result","renderDiagram","handleSave","bpmnModeler","saveXML","format","err","xml","console","log","handleRedo","get","handleUndo","handleDownloadSvg","saveSVG","handleDownloadXml","handleZoom","radio","newScale","state","scale","setState","importXML","BpmnModeler","container","propertiesPanel","parent","additionalModules","propertiesPanelModule","propertiesProviderModule","moddleExtensions","camunda","camundaModdleDescriptor","canvas","id","panel","style","height","components_EditingTools","App","overflow","containers_Bpmn","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.9ff758e9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"editingTools\":\"EditingTools_editingTools__3BjLV\",\"controlList\":\"EditingTools_controlList__3DwUk\",\"control\":\"EditingTools_control__3kG9V\",\"openFile\":\"EditingTools_openFile__ra64W\",\"line\":\"EditingTools_line__7uRkg\",\"zoom\":\"EditingTools_zoom__3fiMx\",\"zoomIn\":\"EditingTools_zoomIn__1Nddh\",\"zoomOut\":\"EditingTools_zoomOut__3KIMl\",\"undo\":\"EditingTools_undo__1aCVV\",\"redo\":\"EditingTools_redo__2l3ae\",\"save\":\"EditingTools_save__1WUw5\",\"download\":\"EditingTools_download__VC08N\",\"image\":\"EditingTools_image__2NQEQ\",\"open\":\"EditingTools_open__HLJgy\"};","import React, { Component } from 'react';\r\nimport styles from './index.module.scss';\r\n\r\nclass EditingTools extends Component {\r\n  handleOpen = () => {\r\n    this.file.click();\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      onOpenFIle,\r\n      onZoomIn,\r\n      onZoomOut,\r\n      onZoomReset,\r\n      onUndo,\r\n      onRedo,\r\n      onSave,\r\n      onDownloadXml,\r\n      onDownloadSvg\r\n    } = this.props;\r\n    return (\r\n      <div className={styles.editingTools}>\r\n        <ul className={styles.controlList}>\r\n          <li className={`${styles.control} ${styles.line}`}>\r\n            <input\r\n              ref={(file) => {\r\n                this.file = file;\r\n              }}\r\n              className={styles.openFile}\r\n              type=\"file\"\r\n              onChange={onOpenFIle}\r\n            />\r\n            <button type=\"button\" title=\"open\" onClick={this.handleOpen}>\r\n              <i className={styles.open} />\r\n            </button>\r\n          </li>\r\n\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"undo\" onClick={onUndo}>\r\n              <i className={styles.undo} />\r\n            </button>\r\n          </li>\r\n          <li className={`${styles.control} ${styles.line}`}>\r\n            <button type=\"button\" title=\"redo\" onClick={onRedo}>\r\n              <i className={styles.redo} />\r\n            </button>\r\n          </li>\r\n\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"reset zoom\" onClick={onZoomReset}>\r\n              <i className={styles.zoom} />\r\n            </button>\r\n          </li>\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"zoom in\" onClick={onZoomIn}>\r\n              <i className={styles.zoomIn} />\r\n            </button>\r\n          </li>\r\n          <li className={`${styles.control} ${styles.line}`}>\r\n            <button type=\"button\" title=\"zoom out\" onClick={onZoomOut}>\r\n              <i className={styles.zoomOut} />\r\n            </button>\r\n          </li>\r\n\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"save\" onClick={onSave}>\r\n              <i className={styles.save} />\r\n            </button>\r\n          </li>\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"download bpmn diagram\" onClick={onDownloadXml}>\r\n              <i className={styles.download} />\r\n            </button>\r\n          </li>\r\n          <li className={styles.control}>\r\n            <button type=\"button\" title=\"download as svg image\" onClick={onDownloadSvg}>\r\n              <i className={styles.image} />\r\n            </button>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default EditingTools;\r\n","import React, { Component } from 'react';\r\nimport BpmnModeler from 'bpmn-js/lib/Modeler';\r\nimport propertiesPanelModule from 'bpmn-js-properties-panel';\r\nimport camundaModdleDescriptor from 'camunda-bpmn-moddle/resources/camunda';\r\nimport propertiesProviderModule from 'bpmn-js-properties-panel/lib/provider/camunda';\r\nimport EditingTools from '../components/EditingTools';\r\nimport { diagramXML } from '../sources/xml';\r\nimport './Common.sass';\r\nimport styles from './Bpmn.module.scss';\r\n\r\nexport default class Bpmn extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      scale: 1 // 流程图比例\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.bpmnModeler = new BpmnModeler({\r\n      container: '#canvas',\r\n      propertiesPanel: {\r\n        parent: '#properties-panel'\r\n      },\r\n      additionalModules: [propertiesPanelModule, propertiesProviderModule],\r\n      moddleExtensions: {\r\n        camunda: camundaModdleDescriptor\r\n      }\r\n    });\r\n\r\n    this.renderDiagram(diagramXML);\r\n  }\r\n\r\n  /**\r\n   * 下载xml/svg\r\n   *  @param  type  类型  svg / xml\r\n   *  @param  data  数据\r\n   *  @param  name  文件名称\r\n   */\r\n  download = (type, data, name) => {\r\n    let dataTrack = '';\r\n    const a = document.createElement('a');\r\n\r\n    switch (type) {\r\n      case 'xml':\r\n        dataTrack = 'bpmn';\r\n        break;\r\n      case 'svg':\r\n        dataTrack = 'svg';\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    name = name || `diagram.${dataTrack}`;\r\n\r\n    a.setAttribute('href', `data:application/bpmn20-xml;charset=UTF-8,${encodeURIComponent(data)}`);\r\n    a.setAttribute('target', '_blank');\r\n    a.setAttribute('dataTrack', `diagram:download-${dataTrack}`);\r\n    a.setAttribute('download', name);\r\n\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n  };\r\n\r\n  // 导入xml文件\r\n  handleOpenFile = (e) => {\r\n    const that = this;\r\n    const file = e.target.files[0];\r\n    const reader = new FileReader();\r\n    let data = '';\r\n    reader.readAsText(file);\r\n    reader.onload = function (event) {\r\n      data = event.target.result;\r\n      that.renderDiagram(data, 'open');\r\n    };\r\n  };\r\n\r\n  // 保存\r\n  handleSave = () => {\r\n    this.bpmnModeler.saveXML({ format: true }, (err, xml) => {\r\n      console.log(xml);\r\n    });\r\n  };\r\n\r\n  // 前进\r\n  handleRedo = () => {\r\n    this.bpmnModeler.get('commandStack').redo();\r\n  };\r\n\r\n  // 后退\r\n  handleUndo = () => {\r\n    this.bpmnModeler.get('commandStack').undo();\r\n  };\r\n\r\n  // 下载SVG格式\r\n  handleDownloadSvg = () => {\r\n    this.bpmnModeler.saveSVG({ format: true }, (err, data) => {\r\n      this.download('svg', data);\r\n    });\r\n  };\r\n\r\n  // 下载XML格式\r\n  handleDownloadXml = () => {\r\n    this.bpmnModeler.saveXML({ format: true }, (err, data) => {\r\n      this.download('xml', data);\r\n    });\r\n  };\r\n\r\n  // 流程图放大缩小\r\n  handleZoom = (radio) => {\r\n    const newScale = !radio\r\n      ? 1.0 // 不输入radio则还原\r\n      : this.state.scale + radio <= 0.2 // 最小缩小倍数\r\n        ? 0.2\r\n        : this.state.scale + radio;\r\n\r\n    this.bpmnModeler.get('canvas').zoom(newScale);\r\n    this.setState({\r\n      scale: newScale\r\n    });\r\n  };\r\n\r\n  renderDiagram = (xml) => {\r\n    this.bpmnModeler.importXML(xml, (err) => {\r\n      if (err) {\r\n        console.log('导入失败');\r\n      } else {\r\n        console.log('导入成功');\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.canvas} id=\"canvas\" />\r\n        <div\r\n          className={`properties-panel-parent ${styles.panel}`}\r\n          id=\"properties-panel\"\r\n          style={{ height: '100%' }}\r\n        />\r\n        <EditingTools\r\n          onOpenFIle={this.handleOpenFile}\r\n          onSave={this.handleSave}\r\n          onUndo={this.handleUndo}\r\n          onRedo={this.handleRedo}\r\n          onDownloadSvg={this.handleDownloadSvg}\r\n          onDownloadXml={this.handleDownloadXml}\r\n          onZoomIn={() => this.handleZoom(0.1)}\r\n          onZoomOut={() => this.handleZoom(-0.1)}\r\n          onZoomReset={() => this.handleZoom()}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export const diagramXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<bpmn2:definitions\r\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n  xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\"\r\n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\"\r\n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\"\r\n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\"\r\n  xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\r\n  id=\"sample-diagram\"\r\n  targetNamespace=\"http://bpmn.io/schema/bpmn\"\r\n>\r\n  <bpmn2:process id=\"Process_1\" isExecutable=\"false\">\r\n    <bpmn2:startEvent id=\"StartEvent_1\"/>\r\n  </bpmn2:process>\r\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\r\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\r\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\r\n        <dc:Bounds height=\"36.0\" width=\"36.0\" x=\"412.0\" y=\"240.0\"/>\r\n      </bpmndi:BPMNShape>\r\n    </bpmndi:BPMNPlane>\r\n  </bpmndi:BPMNDiagram>\r\n</bpmn2:definitions>`;\r\n","import React, { Component } from 'react';\r\nimport EditorBasic from './containers';\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div style={{ height: '100%', overflow: 'hidden' }}>\r\n        <EditorBasic />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Bpmn_container__3-60P\",\"canvas\":\"Bpmn_canvas__2yP6g\",\"panel\":\"Bpmn_panel__3SynY\"};"],"sourceRoot":""}