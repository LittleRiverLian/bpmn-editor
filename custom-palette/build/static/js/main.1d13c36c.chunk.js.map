{"version":3,"sources":["containers/modeler/customPalette/palette/Palette.js","containers/modeler/customPalette/palette/index.js","containers/modeler/customPalette/CustomPalette.js","containers/modeler/customPalette/index.js","containers/modeler/index.js","sources/xml.js","containers/index.js","App.js","index.js","containers/Bpmn.module.scss"],"names":["ELEMENT_SELECTOR","concat","Palette","eventBus","canvas","this","_eventBus","_canvas","_providers","self","on","event","tool","updateToolHighlight","_update","_diagramInitialized","length","_init","$inject","prototype","registerProvider","provider","push","_container","getEntries","entries","forEach","e","getPaletteEntries","entry","id","domify","HTML_MARKUP","parent","domClosest","getContainer","container","insertBefore","children","domDelegate","bind","target","delegateTarget","domMatches","toggle","slide","trigger","domEvent","stopPropagation","_layoutChanged","fire","_toggleState","state","_getParentContainer","cls","domClasses","twoColumn","_needsCollapse","clientHeight","_entries","open","isOpen","entriesContainer","domQuery","domClear","items","grouping","group","content","header","title","appendChild","add","html","separator","control","icon","className","label","domAttr","imageUrl","action","autoActivate","button","preventDefault","item","handler","originalEvent","isFunction","availableHeight","Object","keys","close","contentClasses","headerClasses","has","remove","containerClasses","setAttribute","isActiveTool","_activeTool","name","_toolsContainer","toolsContainer","actionName","getAttribute","toolClasses","replace","contains","palette","__init__","PaletteProvider","create","elementFactory","spaceTool","lassoTool","handTool","translate","actions","createAction","type","options","createListener","shape","createShape","assign","businessObject","di","isExpanded","start","shortType","dragstart","click","objectSpread","eventDefinitionType","customPalette","__depends__","PaletteModule","paletteProvider","CustomPalette","CustomModeler","Modeler","call","customElements","inherits","_modules","Bpmn","renderDiagram","xml","_this","bpmnModeler","importXML","err","console","log","BpmnModeler","propertiesPanel","additionalModules","propertiesPanelModule","propertiesProviderModule","moddleExtensions","camunda","camundaModdleDescriptor","react_default","a","createElement","styles","panel","style","height","Component","App","overflow","containers_Bpmn","ReactDOM","render","src_App","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.1d13c36c.chunk.js","sourcesContent":["import {\r\n  isFunction,\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  domify,\r\n  query as domQuery,\r\n  closest as domClosest,\r\n  attr as domAttr,\r\n  clear as domClear,\r\n  classes as domClasses,\r\n  matches as domMatches,\r\n  delegate as domDelegate,\r\n  event as domEvent\r\n} from 'min-dom';\r\n\r\n\r\nconst TOGGLE_SELECTOR = '.djs-collapse-header';\r\nconst ENTRY_SELECTOR = '.entry';\r\nconst SLIDE_SELECTOR = '.djs-palette-toggle';\r\nconst ELEMENT_SELECTOR = `${TOGGLE_SELECTOR}, ${ENTRY_SELECTOR}, ${SLIDE_SELECTOR}`;\r\n\r\nconst PALETTE_OPEN_CLS = 'open';\r\nconst PALETTE_TWO_COLUMN_CLS = 'two-column';\r\n\r\n\r\n/**\r\n * A palette containing modeling elements.\r\n */\r\nexport default function Palette(eventBus, canvas) {\r\n  this._eventBus = eventBus;\r\n  this._canvas = canvas;\r\n\r\n  this._providers = [];\r\n\r\n  const self = this;\r\n\r\n  eventBus.on('tool-manager.update', (event) => {\r\n    const { tool } = event;\r\n\r\n    self.updateToolHighlight(tool);\r\n  });\r\n\r\n  eventBus.on('i18n.changed', () => {\r\n    self._update();\r\n  });\r\n\r\n  eventBus.on('diagram.init', () => {\r\n    self._diagramInitialized = true;\r\n\r\n    // initialize + update once diagram is ready\r\n    if (self._providers.length) {\r\n      self._init();\r\n\r\n      self._update();\r\n    }\r\n  });\r\n}\r\n\r\nPalette.$inject = ['eventBus', 'canvas'];\r\n\r\n\r\n/**\r\n * Register a provider with the palette\r\n *\r\n * @param  {PaletteProvider} provider\r\n */\r\nPalette.prototype.registerProvider = function (provider) {\r\n  this._providers.push(provider);\r\n\r\n  // postpone init / update until diagram is initialized\r\n  if (!this._diagramInitialized) {\r\n    return;\r\n  }\r\n\r\n  if (!this._container) {\r\n    this._init();\r\n  }\r\n\r\n  this._update();\r\n};\r\n\r\n\r\n/**\r\n * Returns the palette entries for a given element\r\n *\r\n * @return {Array<PaletteEntryDescriptor>} list of entries\r\n */\r\nPalette.prototype.getEntries = function () {\r\n  const entries = {};\r\n\r\n  // loop through all providers and their entries.\r\n  // group entries by id so that overriding an entry is possible\r\n  forEach(this._providers, (provider) => {\r\n    const e = provider.getPaletteEntries();\r\n\r\n    forEach(e, (entry, id) => {\r\n      entries[id] = entry;\r\n    });\r\n  });\r\n\r\n  return entries;\r\n};\r\n\r\n\r\n/**\r\n * Initialize\r\n */\r\nPalette.prototype._init = function () {\r\n  const canvas = this._canvas;\r\n  const eventBus = this._eventBus;\r\n  this._container = domify(Palette.HTML_MARKUP);\r\n  const parent = domClosest(canvas.getContainer(), '.bjs-container');\r\n  const container = this._container;\r\n  const self = this;\r\n\r\n  parent.insertBefore(container, parent.children[0]);\r\n\r\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', (event) => {\r\n    const target = event.delegateTarget;\r\n\r\n    // 菜单伸缩\r\n    if (domMatches(target, TOGGLE_SELECTOR)) {\r\n      return self.toggle(target);\r\n    }\r\n\r\n    // 左侧栏伸缩\r\n    if (domMatches(target, SLIDE_SELECTOR)) {\r\n      return self.slide(target);\r\n    }\r\n\r\n    self.trigger('click', event);\r\n  });\r\n\r\n  // prevent drag propagation\r\n  domEvent.bind(container, 'mousedown', (event) => {\r\n    event.stopPropagation();\r\n  });\r\n\r\n  // prevent drag propagation\r\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', (event) => {\r\n    self.trigger('dragstart', event);\r\n  });\r\n\r\n  eventBus.on('canvas.resized', this._layoutChanged, this);\r\n\r\n  eventBus.fire('palette.create', {\r\n    container\r\n  });\r\n};\r\n\r\n/**\r\n * Update palette state.\r\n *\r\n * @param  {Object} [state] { open, twoColumn }\r\n */\r\nPalette.prototype._toggleState = function (state) {\r\n  state = state || {};\r\n\r\n  const parent = this._getParentContainer();\r\n  const container = this._container;\r\n  const eventBus = this._eventBus;\r\n  const cls = domClasses(container);\r\n  const twoColumn = state.twoColumn || this._needsCollapse(parent.clientHeight, this._entries || {});\r\n\r\n  // always update two column\r\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\r\n  if ('open' in state) {\r\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\r\n  }\r\n\r\n  eventBus.fire('palette.changed', {\r\n    twoColumn,\r\n    open: this.isOpen()\r\n  });\r\n};\r\n\r\nPalette.prototype._update = function () {\r\n  this._entries = this.getEntries();\r\n  const entriesContainer = domQuery('.djs-palette-entries', this._container);\r\n  const entries = this._entries;\r\n\r\n  domClear(entriesContainer);\r\n\r\n  forEach(entries, (items) => {\r\n    const grouping = items.group || 'default';\r\n\r\n    let container = domQuery(`[data-group=${grouping}]`, entriesContainer);\r\n    let content = domQuery('.djs-collapse-content', container);\r\n    const header = domify(`<div class=\"djs-collapse-header open\">${items.title}</div>`);\r\n\r\n    if (!container) {\r\n      container = domify(`<div class=\"group\" data-group=\"${grouping}\"></div>`);\r\n      content = domify('<div class=\"djs-collapse-content open\"></div>');\r\n      container.appendChild(header);\r\n      container.appendChild(content);\r\n      entriesContainer.appendChild(container);\r\n    }\r\n\r\n    // 如果不存在children，则不显示该菜单项\r\n    if (items.children.length === 0) {\r\n      const containerClass = domClasses(container);\r\n      containerClass.add('hidden');\r\n    }\r\n\r\n    forEach(items.children, (entry) => {\r\n      const html = entry.html || (\r\n        entry.separator\r\n          ? '<hr class=\"separator\" />'\r\n          : '<div class=\"entry\" draggable=\"true\"></div>');\r\n\r\n      const control = domify(html);\r\n      const icon = domify(`<i class=\"content-icon ${entry.className}\"></i>`);\r\n      const label = domify(`<span class=\"content-label\">${entry.title}</span>`);\r\n      control.appendChild(icon);\r\n      control.appendChild(label);\r\n      content.appendChild(control);\r\n\r\n      if (!entry.separator) {\r\n        domAttr(control, 'data-action', entry.id);\r\n\r\n        if (entry.title) {\r\n          domAttr(control, 'title', entry.title);\r\n        }\r\n\r\n        if (entry.imageUrl) {\r\n          control.appendChild(domify(`<img src=\"${entry.imageUrl}\">`));\r\n        }\r\n      }\r\n    });\r\n  });\r\n\r\n  // open after update\r\n  this.open();\r\n};\r\n\r\n\r\n/**\r\n * Trigger an action available on the palette\r\n *\r\n * @param  {String} action\r\n * @param  {Event} event\r\n */\r\nPalette.prototype.trigger = function (action, event, autoActivate) {\r\n  const entries = this._entries;\r\n  let entry;\r\n  const button = event.delegateTarget || event.target;\r\n\r\n  if (!button) {\r\n    return event.preventDefault();\r\n  }\r\n\r\n  forEach(entries, (items) => {\r\n    forEach(items.children, (item) => {\r\n      if (item.id === domAttr(button, 'data-action')) {\r\n        entry = item;\r\n      }\r\n    });\r\n  });\r\n\r\n  // when user clicks on the palette and not on an action\r\n  if (!entry) {\r\n    return;\r\n  }\r\n\r\n  const handler = entry.action;\r\n  const originalEvent = event.originalEvent || event;\r\n\r\n  // simple action (via callback function)\r\n  if (isFunction(handler)) {\r\n    if (action === 'click') {\r\n      handler(originalEvent, autoActivate);\r\n    }\r\n  } else if (handler[action]) {\r\n    handler[action](originalEvent, autoActivate);\r\n  }\r\n\r\n  // silence other actions\r\n  event.preventDefault();\r\n};\r\n\r\nPalette.prototype._layoutChanged = function () {\r\n  this._toggleState({});\r\n};\r\n\r\n/**\r\n * Do we need to collapse to two columns?\r\n *\r\n * @param {Number} availableHeight\r\n * @param {Object} entries\r\n *\r\n * @return {Boolean}\r\n */\r\nPalette.prototype._needsCollapse = function (availableHeight, entries) {\r\n  // top margin + bottom toggle + bottom margin\r\n  // implementors must override this method if they\r\n  // change the palette styles\r\n  const margin = 20 + 10 + 20;\r\n\r\n  const entriesHeight = Object.keys(entries).length * 46;\r\n\r\n  return availableHeight < entriesHeight + margin;\r\n};\r\n\r\n/**\r\n * Close the palette\r\n */\r\nPalette.prototype.close = function () {\r\n  this._toggleState({\r\n    open: false,\r\n    twoColumn: false\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Open the palette\r\n */\r\nPalette.prototype.open = function () {\r\n  this._toggleState({ open: true });\r\n};\r\n\r\n// 伸缩菜单\r\nPalette.prototype.toggle = function (target) {\r\n  const group = domClosest(target, '.group');\r\n  const content = domQuery('.djs-collapse-content', group);\r\n  const contentClasses = domClasses(content);\r\n  const headerClasses = domClasses(target);\r\n  const isOpen = contentClasses.has('open');\r\n  if (isOpen) {\r\n    contentClasses.remove('open');\r\n    headerClasses.remove('open');\r\n  } else {\r\n    contentClasses.add('open');\r\n    headerClasses.add('open');\r\n  }\r\n};\r\n\r\n// 伸缩左侧栏\r\nPalette.prototype.slide = function (target) {\r\n  const containerClasses = domClasses(this._container);\r\n  const isRetract = containerClasses.has('retract');\r\n  if (isRetract) {\r\n    containerClasses.remove('retract');\r\n    target.setAttribute('title', '收起');\r\n  } else {\r\n    containerClasses.add('retract');\r\n    target.setAttribute('title', '展开');\r\n  }\r\n};\r\n\r\nPalette.prototype.isActiveTool = function (tool) {\r\n  return tool && this._activeTool === tool;\r\n};\r\n\r\nPalette.prototype.updateToolHighlight = function (name) {\r\n  let entriesContainer;\r\n\r\n  if (!this._toolsContainer) {\r\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\r\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\r\n  }\r\n\r\n  const toolsContainer = this._toolsContainer;\r\n\r\n  forEach(toolsContainer.children, (tool) => {\r\n    let actionName = tool.getAttribute('data-action');\r\n\r\n    if (!actionName) {\r\n      return;\r\n    }\r\n\r\n    const toolClasses = domClasses(tool);\r\n\r\n    actionName = actionName.replace('-tool', '');\r\n\r\n    if (toolClasses.contains('entry') && actionName === name) {\r\n      toolClasses.add('highlighted-entry');\r\n    } else {\r\n      toolClasses.remove('highlighted-entry');\r\n    }\r\n  });\r\n};\r\n\r\n\r\n/**\r\n * Return true if the palette is opened.\r\n *\r\n * @example\r\n *\r\n * palette.open();\r\n *\r\n * if (palette.isOpen()) {\r\n *   // yes, we are open\r\n * }\r\n *\r\n * @return {boolean} true if palette is opened\r\n */\r\nPalette.prototype.isOpen = function () {\r\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\r\n};\r\n\r\n/**\r\n * Get container the palette lives in.\r\n *\r\n * @return {Element}\r\n */\r\nPalette.prototype._getParentContainer = function () {\r\n  return this._canvas.getContainer();\r\n};\r\n\r\n\r\n/* markup definition */\r\n\r\nPalette.HTML_MARKUP = '<div class=\"djs-palette\">'\r\n    + '<div class=\"djs-palette-entries\"></div>'\r\n    + '<div class=\"djs-palette-toggle\" title=\"收起\"></div>'\r\n  + '</div>';\r\n\r\n\r\n// helpers //////////////////////\r\n\r\n// function addClasses(element, classNames) {\r\n//   const classes = domClasses(element);\r\n\r\n//   const actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\r\n//   actualClassNames.forEach((cls) => {\r\n//     classes.add(cls);\r\n//   });\r\n// }\r\n","import Palette from './Palette';\r\n\r\nexport default {\r\n  __init__: ['palette'],\r\n  palette: ['type', Palette]\r\n};\r\n","import {\r\n  assign\r\n} from 'min-dash';\r\n\r\n/**\r\n * A palette that allows you to create BPMN _and_ custom elements.\r\n */\r\nexport default function PaletteProvider(palette, create, elementFactory, spaceTool, lassoTool, handTool, translate) {\r\n  this.create = create;\r\n  this.elementFactory = elementFactory;\r\n  this.spaceTool = spaceTool;\r\n  this.lassoTool = lassoTool;\r\n  this.handTool = handTool;\r\n  this.translate = translate;\r\n\r\n  palette.registerProvider(this);\r\n}\r\n\r\nPaletteProvider.$inject = [\r\n  'palette',\r\n  'create',\r\n  'elementFactory',\r\n  'spaceTool',\r\n  'lassoTool',\r\n  'handTool',\r\n  'translate'\r\n];\r\n\r\n\r\nPaletteProvider.prototype.getPaletteEntries = function () {\r\n  const actions = [];\r\n  const { create, elementFactory, translate } = this;\r\n\r\n  function createAction(type, group, className, title, options) {\r\n    function createListener(event) {\r\n      const shape = elementFactory.createShape(assign({ type }, options));\r\n\r\n      if (options) {\r\n        shape.businessObject.di.isExpanded = options.isExpanded;\r\n      }\r\n\r\n      create.start(event, shape);\r\n    }\r\n\r\n    const shortType = type.replace(/^bpmn:/, '');\r\n\r\n    return {\r\n      group,\r\n      className,\r\n      title: translate(title || 'Create {type}', { type: shortType }),\r\n      action: {\r\n        dragstart: createListener,\r\n        click: createListener\r\n      }\r\n    };\r\n  }\r\n\r\n  assign(actions, [\r\n    {\r\n      title: translate('Start Events'),\r\n      group: 'startEvents',\r\n      children: [\r\n        {\r\n          id: 'create.start-event',\r\n          ...createAction('bpmn:StartEvent', 'event', 'bpmn-icon-start-event-none')\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: translate('Intermediate Events'),\r\n      group: 'intermediateEvents',\r\n      children: [\r\n        {\r\n          id: 'create.intermediate-event',\r\n          ...createAction('bpmn:IntermediateThrowEvent', 'event', 'bpmn-icon-intermediate-event-none')\r\n        },\r\n        {\r\n          id: 'create.intermediate-event-catch-timer',\r\n          ...createAction('bpmn:IntermediateCatchEvent', 'event', 'bpmn-icon-intermediate-event-catch-timer', 'Intermediate Event Catch Timer', { eventDefinitionType: 'bpmn:TimerEventDefinition' })\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: translate('Boundary Events'),\r\n      group: 'boundaryEvents',\r\n      children: [\r\n        {\r\n          id: 'create.boundary-event-catch-timer',\r\n          ...createAction('bpmn:BoundaryEvent', 'event', 'bpmn-icon-intermediate-event-catch-timer', 'Boundary Event Timer', { eventDefinitionType: 'bpmn:TimerEventDefinition' })\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: translate('End Events'),\r\n      group: 'endEvents',\r\n      children: [\r\n        {\r\n          id: 'create.end-event',\r\n          ...createAction('bpmn:EndEvent', 'event', 'bpmn-icon-end-event-none')\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: translate('Activities'),\r\n      group: 'activities',\r\n      children: [\r\n        {\r\n          id: 'create.task',\r\n          ...createAction('bpmn:Task', 'activity', 'bpmn-icon-task')\r\n        },\r\n        {\r\n          id: 'create.userTask',\r\n          ...createAction('bpmn:UserTask', 'activity', 'bpmn-icon-user-task')\r\n        },\r\n        {\r\n          id: 'create.serviceTask',\r\n          ...createAction('bpmn:ServiceTask', 'activity', 'bpmn-icon-service-task')\r\n        }\r\n      ]\r\n    },\r\n    {\r\n      title: translate('Gateways'),\r\n      group: 'gateways',\r\n      children: [\r\n        {\r\n          id: 'create.exclusive-gateway',\r\n          ...createAction('bpmn:ExclusiveGateway', 'gateway', 'bpmn-icon-gateway-xor')\r\n        },\r\n        {\r\n          id: 'create.parallel-gateway',\r\n          ...createAction('bpmn:ParallelGateway', 'gateway', 'bpmn-icon-gateway-parallel')\r\n        }\r\n      ]\r\n    }\r\n  ]);\r\n\r\n  return actions;\r\n};\r\n","/*\r\n * @Author: Eric\r\n * @Date: 2018-06-07 13:19:34\r\n * @Last Modified by: Eric\r\n * @Last Modified time: 2018-06-07 13:20:02\r\n * @功能：自定义左侧面板\r\n */\r\nimport PaletteModule from './palette';\r\nimport CustomPalette from './CustomPalette';\r\n\r\nexport default {\r\n  __depends__: [\r\n    PaletteModule\r\n  ],\r\n  __init__: ['paletteProvider'],\r\n  paletteProvider: ['type', CustomPalette]\r\n};\r\n","import Modeler from 'bpmn-js/lib/Modeler';\r\n\r\nimport inherits from 'inherits';\r\n\r\nimport CustomPalette from './customPalette';\r\n\r\nexport default function CustomModeler(options) {\r\n  Modeler.call(this, options);\r\n\r\n  this.customElements = [];\r\n}\r\n\r\ninherits(CustomModeler, Modeler);\r\n\r\nCustomModeler.prototype._modules = [].concat(\r\n  CustomModeler.prototype._modules,\r\n  [\r\n    CustomPalette\r\n  ]\r\n);\r\n","export const diagramXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<bpmn2:definitions\r\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n  xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\"\r\n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\"\r\n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\"\r\n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\"\r\n  xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\r\n  id=\"sample-diagram\"\r\n  targetNamespace=\"http://bpmn.io/schema/bpmn\"\r\n>\r\n  <bpmn2:process id=\"Process_1\" isExecutable=\"false\">\r\n    <bpmn2:startEvent id=\"StartEvent_1\"/>\r\n  </bpmn2:process>\r\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\r\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\r\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\r\n        <dc:Bounds height=\"36.0\" width=\"36.0\" x=\"412.0\" y=\"240.0\"/>\r\n      </bpmndi:BPMNShape>\r\n    </bpmndi:BPMNPlane>\r\n  </bpmndi:BPMNDiagram>\r\n</bpmn2:definitions>`;\r\n","import React, { Component } from 'react';\r\nimport propertiesPanelModule from 'bpmn-js-properties-panel';\r\nimport propertiesProviderModule from 'bpmn-js-properties-panel/lib/provider/camunda';\r\nimport camundaModdleDescriptor from 'camunda-bpmn-moddle/resources/camunda';\r\nimport BpmnModeler from './modeler';\r\nimport { diagramXML } from '../sources/xml';\r\nimport './Common.sass';\r\nimport styles from './Bpmn.module.scss';\r\n\r\nexport default class Bpmn extends Component {\r\n  componentDidMount() {\r\n    this.bpmnModeler = new BpmnModeler({\r\n      container: '#canvas',\r\n      propertiesPanel: {\r\n        parent: '#properties-panel'\r\n      },\r\n      additionalModules: [propertiesPanelModule, propertiesProviderModule],\r\n      moddleExtensions: {\r\n        camunda: camundaModdleDescriptor\r\n      }\r\n    });\r\n\r\n    this.renderDiagram(diagramXML);\r\n  }\r\n\r\n  renderDiagram = (xml) => {\r\n    this.bpmnModeler.importXML(xml, (err) => {\r\n      if (err) {\r\n        console.log('导入失败');\r\n      } else {\r\n        console.log('导入成功');\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.canvas} id=\"canvas\" />\r\n        <div\r\n          className={`properties-panel-parent ${styles.panel}`}\r\n          id=\"properties-panel\"\r\n          style={{ height: '100%' }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","import React, { Component } from 'react';\r\nimport EditorBasic from './containers';\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div style={{ height: '100%', overflow: 'hidden' }}>\r\n        <EditorBasic />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Bpmn_container__30R88\",\"canvas\":\"Bpmn_canvas__CC3O-\"};"],"sourceRoot":""}