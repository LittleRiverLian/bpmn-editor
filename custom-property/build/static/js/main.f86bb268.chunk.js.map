{"version":3,"sources":["containers/magic/parts/InputTxtProps.js","containers/magic/parts/CheckboxProps.js","containers/magic/parts/SelectProps.js","containers/magic/parts/UserCustomProps.js","containers/magic/parts/DynamicSelectProps.js","containers/magic/MagicPropertiesProvider.js","containers/magic/index.js","containers/index.js","sources/xml.js","App.js","index.js","containers/Bpmn.module.scss"],"names":["InputTxtProps","group","element","bpmnFactory","translate","entries","push","entryFactory","textField","id","label","modelProperty","CheckboxProps","checkboxGroup","checkbox","options","name","value","SelectProps","selectGroup","selectBox","selectOptions","get","el","customSelect","getBusinessObject","set","bo","props","obj","setSelect","cmdHelper","updateBusinessObject","UserCustomProps","is","DynamicSelectProps","html","dynamicSelect","addElement","inputNode","ms","Promise","resolve","setTimeout","val","then","console","log","node","query","parentElement","forEach","removeChild","firstChild","i","optionTemplate","domify","concat","insertBefore","option","attr","MagicPropertiesProvider","eventBus","elementRegistry","PropertiesActivator","call","this","getTabs","groups","generalGroup","inputTxtProps","checkboxProps","selectProps","userCustomProps","createGeneralTabGroups","inherits","magic","__init__","propertiesProvider","Bpmn","renderDiagram","xml","_this","bpmnModeler","importXML","err","BpmnModeler","container","propertiesPanel","parent","additionalModules","propertiesPanelModule","propertiesProviderModule","moddleExtensions","camunda","camundaModdleDescriptor","react_default","a","createElement","className","styles","canvas","panel","style","height","Component","App","overflow","containers_Bpmn","ReactDOM","render","src_App","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.f86bb268.chunk.js","sourcesContent":["import entryFactory from 'bpmn-js-properties-panel/lib/factory/EntryFactory';\r\n\r\nexport default function (group, element, bpmnFactory, translate) {\r\n  group.entries.push(entryFactory.textField({\r\n    id: 'customTxt',\r\n    label: translate('自定义输入框'),\r\n    modelProperty: 'camunda:customTxt'\r\n  }));\r\n}\r\n","import entryFactory from 'bpmn-js-properties-panel/lib/factory/EntryFactory';\r\n\r\nexport default function (group, element, bpmnFactory, translate) {\r\n  const checkboxGroup = entryFactory.checkbox({\r\n    id: 'customCheckbox',\r\n    label: translate('自定义复选框'),\r\n    modelProperty: 'camunda:customCheckbox'\r\n  });\r\n\r\n  group.entries.push(checkboxGroup);\r\n}\r\n","import entryFactory from 'bpmn-js-properties-panel/lib/factory/EntryFactory';\r\nimport { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\r\nimport cmdHelper from 'bpmn-js-properties-panel/lib/helper/CmdHelper';\r\n\r\nconst options = [\r\n  { name: 'html', value: 'html' },\r\n  { name: 'js', value: 'js' },\r\n  { name: 'css', value: 'css' }\r\n];\r\n\r\nfunction getSelect(element) {\r\n  const bo = getBusinessObject(element);\r\n  const selectedOption = bo.get('camunda:customSelect');\r\n\r\n  return selectedOption;\r\n}\r\n\r\nfunction setSelect(element, value) {\r\n  const obj = {};\r\n  obj['camunda:customSelect'] = value.customSelect;\r\n\r\n  return obj;\r\n}\r\n\r\nexport default function (group, element, bpmnFactory, translate) {\r\n  const selectGroup = entryFactory.selectBox({\r\n    id: 'customSelect',\r\n    label: translate('自定义下拉框'),\r\n    selectOptions: options,\r\n    modelProperty: 'customSelect',\r\n    get(el) {\r\n      return {\r\n        customSelect: getSelect(el)\r\n      };\r\n    },\r\n    set(el, value) {\r\n      const bo = getBusinessObject(el);\r\n      const props = setSelect(el, value);\r\n\r\n      return cmdHelper.updateBusinessObject(element, bo, props);\r\n    }\r\n  });\r\n\r\n  group.entries.push(selectGroup);\r\n}\r\n","import entryFactory from 'bpmn-js-properties-panel/lib/factory/EntryFactory';\r\nimport { is } from 'bpmn-js/lib/util/ModelUtil';\r\n\r\nexport default function (group, element, bpmnFactory, translate) {\r\n  if (!is(element, 'bpmn:UserTask')) return;\r\n\r\n  group.entries.push(entryFactory.textField({\r\n    id: 'userCustom',\r\n    label: translate('用户任务'),\r\n    modelProperty: 'camunda:userCustom'\r\n  }));\r\n}\r\n","import { getBusinessObject } from 'bpmn-js/lib/util/ModelUtil';\r\nimport cmdHelper from 'bpmn-js-properties-panel/lib/helper/CmdHelper';\r\nimport { query, domify, attr } from 'min-dom/dist';\r\nimport { forEach } from 'lodash/collection';\r\n\r\nfunction getData(ms) {\r\n  return new Promise((resolve) => {\r\n    setTimeout(resolve, ms, { val: 1 });\r\n  });\r\n}\r\n\r\nfunction getSelectBox(node) {\r\n  return query('select[name=dynamicSelect]', node.parentElement);\r\n}\r\n\r\nfunction getSelect(element) {\r\n  const bo = getBusinessObject(element);\r\n  const selectedOption = bo.get('camunda:dynamicSelect');\r\n\r\n  return selectedOption;\r\n}\r\n\r\nfunction setSelect(element, value) {\r\n  const obj = {};\r\n  obj['camunda:dynamicSelect'] = value.dynamicSelect;\r\n\r\n  return obj;\r\n}\r\n\r\nexport default function (group, element) {\r\n  const selectGroup = {\r\n    id: 'dynamicSelect',\r\n    html: '<div class=\"bpp-row bpp-select\">'\r\n             + '<label for=\"dynamic-select\">动态获取列表</label>'\r\n             + '<div class=\"bpp-field-wrapper\">'\r\n               + '<select id=\"dynamic-select\" name=\"dynamicSelect\" data-value>'\r\n               + '</select>'\r\n               + '<button class=\"get-data\" id=\"addElement\" data-action=\"addElement\">获取数据</button>'\r\n             + '</div>'\r\n          + '</div>',\r\n    get(el) {\r\n      return {\r\n        dynamicSelect: getSelect(el)\r\n      };\r\n    },\r\n    set(el, value) {\r\n      const bo = getBusinessObject(el);\r\n      const props = setSelect(el, value);\r\n\r\n      return cmdHelper.updateBusinessObject(element, bo, props);\r\n    },\r\n    addElement(el, inputNode) {\r\n      getData(1000).then((value) => {\r\n        console.log('调用成功', value);\r\n\r\n        const selectBox = getSelectBox(inputNode);\r\n\r\n        forEach(selectBox, () => {\r\n          selectBox.removeChild(selectBox.firstChild);\r\n        });\r\n\r\n        for (let i = 0; i < 10; i += 1) {\r\n          const optionTemplate = domify(`<option value=\"${i}\">${i}</option>`);\r\n          selectBox.insertBefore(optionTemplate, selectBox.firstChild);\r\n        }\r\n\r\n        forEach(selectBox, (option) => {\r\n          if (option.value === 0) {\r\n            attr(option, 'selected', 'selected');\r\n          } else {\r\n            attr(option, 'selected', null);\r\n          }\r\n        });\r\n\r\n        return true;\r\n      });\r\n    }\r\n  };\r\n\r\n  group.entries.push(selectGroup);\r\n}\r\n","import inherits from 'inherits';\nimport PropertiesActivator from 'bpmn-js-properties-panel/lib/PropertiesActivator';\n\nimport inputTxtProps from './parts/InputTxtProps';\nimport checkboxProps from './parts/CheckboxProps';\nimport selectProps from './parts/SelectProps';\nimport userCustomProps from './parts/UserCustomProps';\nimport DynamicSelectProps from './parts/DynamicSelectProps';\n\nfunction createGeneralTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  const generalGroup = {\n    id: 'general',\n    label: '',\n    entries: []\n  };\n\n  inputTxtProps(generalGroup, element, bpmnFactory, translate);\n  checkboxProps(generalGroup, element, bpmnFactory, translate);\n  selectProps(generalGroup, element, bpmnFactory, translate);\n  userCustomProps(generalGroup, element, bpmnFactory, translate);\n  DynamicSelectProps(generalGroup, element, bpmnFactory, translate);\n\n  return [generalGroup];\n}\n\nexport default function MagicPropertiesProvider(eventBus, bpmnFactory, elementRegistry, translate) {\n  PropertiesActivator.call(this, eventBus);\n  this.getTabs = function (element) {\n    const gengralTab = {\n      id: 'general',\n      label: '基本信息',\n      groups: createGeneralTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    return [gengralTab];\n  };\n}\n\ninherits(MagicPropertiesProvider, PropertiesActivator);\n","import MagicPropertiesProvider from './MagicPropertiesProvider';\r\n\r\nexport default {\r\n  __init__: ['propertiesProvider'],\r\n  propertiesProvider: ['type', MagicPropertiesProvider]\r\n};\r\n","import React, { Component } from 'react';\r\nimport BpmnModeler from 'bpmn-js/lib/Modeler';\r\nimport propertiesPanelModule from 'bpmn-js-properties-panel';\r\nimport camundaModdleDescriptor from 'camunda-bpmn-moddle/resources/camunda';\r\nimport propertiesProviderModule from './magic';\r\nimport { diagramXML } from '../sources/xml';\r\nimport './Common.sass';\r\nimport styles from './Bpmn.module.scss';\r\n\r\nexport default class Bpmn extends Component {\r\n  componentDidMount() {\r\n    this.bpmnModeler = new BpmnModeler({\r\n      container: '#canvas',\r\n      propertiesPanel: {\r\n        parent: '#properties-panel'\r\n      },\r\n      additionalModules: [propertiesPanelModule, propertiesProviderModule],\r\n      moddleExtensions: {\r\n        camunda: camundaModdleDescriptor\r\n      }\r\n    });\r\n\r\n    this.renderDiagram(diagramXML);\r\n  }\r\n\r\n  renderDiagram = (xml) => {\r\n    this.bpmnModeler.importXML(xml, (err) => {\r\n      if (err) {\r\n        console.log('导入失败');\r\n      } else {\r\n        console.log('导入成功');\r\n      }\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div className={styles.container}>\r\n        <div className={styles.canvas} id=\"canvas\" />\r\n        <div\r\n          className={`properties-panel-parent ${styles.panel}`}\r\n          id=\"properties-panel\"\r\n          style={{ height: '100%' }}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n","export const diagramXML = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<bpmn2:definitions\r\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\r\n  xmlns:bpmn2=\"http://www.omg.org/spec/BPMN/20100524/MODEL\"\r\n  xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\"\r\n  xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\"\r\n  xmlns:di=\"http://www.omg.org/spec/DD/20100524/DI\"\r\n  xsi:schemaLocation=\"http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd\"\r\n  id=\"sample-diagram\"\r\n  targetNamespace=\"http://bpmn.io/schema/bpmn\"\r\n>\r\n  <bpmn2:process id=\"Process_1\" isExecutable=\"false\">\r\n    <bpmn2:startEvent id=\"StartEvent_1\"/>\r\n  </bpmn2:process>\r\n  <bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">\r\n    <bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">\r\n      <bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">\r\n        <dc:Bounds height=\"36.0\" width=\"36.0\" x=\"412.0\" y=\"240.0\"/>\r\n      </bpmndi:BPMNShape>\r\n    </bpmndi:BPMNPlane>\r\n  </bpmndi:BPMNDiagram>\r\n</bpmn2:definitions>`;\r\n","import React, { Component } from 'react';\r\nimport EditorBasic from './containers';\r\n\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <div style={{ height: '100%', overflow: 'hidden' }}>\r\n        <EditorBasic />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Bpmn_container__rDk4T\",\"canvas\":\"Bpmn_canvas__2-gbo\",\"panel\":\"Bpmn_panel__2gEka\"};"],"sourceRoot":""}